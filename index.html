<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DINO Clicker</title>
<style>
  body { font-family: sans-serif; text-align: center; margin-top: 50px; }
  img { border-radius: 50%; width: 80px; margin-bottom: 20px; }
  button { padding: 10px 20px; font-size: 18px; margin-top: 20px; }
</style>
</head>
<body>

<h1 id="username">Загрузка...</h1>
<img id="avatar" src="" alt="Avatar">
<p>Баланс: <span id="balance">0</span></p>
<button id="clickBtn">Клик!</button>

<script>
  const API_URL = "https://api.dino.ru"; // <- замените на ваш сервер
  let TELEGRAM_ID = prompt("Введите ваш Telegram ID для теста:");
  let USERNAME = prompt("Введите ваш username:");
  let FIRST_NAME = prompt("Введите first_name:");
  let LAST_NAME = prompt("Введите last_name:");
  let AVATAR_URL = prompt("Введите URL аватара (или оставьте пустым):");

  let user = null;

  async function loadUser() {
    try {
      const query = `?telegram_id=${TELEGRAM_ID}&username=${USERNAME}&first_name=${FIRST_NAME}&last_name=${LAST_NAME}&avatar_url=${AVATAR_URL}`;
      const res = await fetch(`${API_URL}/api/user${query}`);
      const data = await res.json();
      if(!data.success) return alert(data.error || 'Ошибка сервера');
      user = data.user;

      document.getElementById("username").innerText = user.username;
      document.getElementById("avatar").src = user.avatar_url || "https://via.placeholder.com/80";
      document.getElementById("balance").innerText = user.balance;
    } catch (err) {
      console.error(err);
      alert("Ошибка при загрузке пользователя");
    }
  }

  async function clickBtn() {
    if(!user) return;
    try {
      // В этом прототипе мы просто увеличиваем баланс локально и обновляем на фронте
      user.balance += user.per_click;
      document.getElementById("balance").innerText = user.balance;

      // В реальном проекте здесь можно сделать POST запрос на сервер для сохранения клика
      // await fetch(`${API_URL}/api/click`, { method: "POST", body: JSON.stringify({ telegram_id: TELEGRAM_ID }) })
    } catch (err) {
      console.error(err);
    }
  }

  document.getElementById("clickBtn").addEventListener("click", clickBtn);

  loadUser();
</script>

</body>
</html>
